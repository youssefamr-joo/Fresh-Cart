"use strict";(self.webpackChunkfreshCart=self.webpackChunkfreshCart||[]).push([[177],{5177:(f,p,i)=>{i.r(p),i.d(p,{PaymentComponent:()=>T});var c=i(6814),r=i(95),t=i(4769),g=i(1120),a=i(6286);function C(e,_){1&e&&(t.TgZ(0,"p",14),t._uU(1," details is required "),t.qZA())}function s(e,_){if(1&e&&(t.TgZ(0,"div",12),t.YNc(1,C,2,0,"p",13),t.qZA()),2&e){const n=t.oxw();let o;t.xp6(1),t.Q6J("ngIf",null==(o=n.orderForm.get("details"))?null:o.getError("required"))}}function u(e,_){1&e&&(t.TgZ(0,"p",14),t._uU(1," phone is required "),t.qZA())}function v(e,_){1&e&&(t.TgZ(0,"p",14),t._uU(1," accept only egypt phone numbers "),t.qZA())}function U(e,_){if(1&e&&(t.TgZ(0,"div",12),t.YNc(1,u,2,0,"p",13),t.YNc(2,v,2,0,"p",13),t.qZA()),2&e){const n=t.oxw();let o,l;t.xp6(1),t.Q6J("ngIf",null==(o=n.orderForm.get("phone"))?null:o.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(l=n.orderForm.get("phone"))?null:l.getError("pattern"))}}function y(e,_){1&e&&(t.TgZ(0,"p",14),t._uU(1," city is required "),t.qZA())}function I(e,_){if(1&e&&(t.TgZ(0,"div",12),t.YNc(1,y,2,0,"p",13),t.qZA()),2&e){const n=t.oxw();let o;t.xp6(1),t.Q6J("ngIf",null==(o=n.orderForm.get("city"))?null:o.getError("required"))}}let T=(()=>{class e{constructor(n,o){this._ActivatedRoute=n,this._CartService=o,this.cartId="",this.orderForm=new r.cw({details:new r.NI("",[r.kI.required]),phone:new r.NI("",[r.kI.required,r.kI.pattern(/^01[0125][0-9]{8}$/)]),city:new r.NI("",[r.kI.required])})}ngOnInit(){this._ActivatedRoute.paramMap.subscribe({next:n=>{this.cartId=n.get("id")}})}handleForm(){this._CartService.checkOut(this.cartId,this.orderForm.value).subscribe({next:n=>{"success"==n.status&&window.open(n.session.url,"_self")}})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(g.gz),t.Y36(a.N))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-payment"]],standalone:!0,features:[t.jDz],decls:21,vars:5,consts:[[1,"w-75","mx-auto","rounded","shadow","p-3","mb-3","bg-main-light"],[1,"p-3"],[3,"formGroup","ngSubmit"],[1,"form-item"],["for","details"],["formControlName","details","type","text","id","details",1,"form-control"],["class","alert alert-danger p-1 small mt-2",4,"ngIf"],["for","phone"],["formControlName","phone","type","tel","id","phone",1,"form-control"],["for","city"],["formControlName","city","type","text","id","city",1,"form-control"],[1,"main-btn","mt-2",3,"disabled"],[1,"alert","alert-danger","p-1","small","mt-2"],["class","text-capitalize m-0 text-center",4,"ngIf"],[1,"text-capitalize","m-0","text-center"]],template:function(o,l){if(1&o&&(t.TgZ(0,"section",0)(1,"h1",1),t._uU(2,"Check Out Now"),t.qZA(),t.TgZ(3,"form",2),t.NdJ("ngSubmit",function(){return l.handleForm()}),t.TgZ(4,"div",3)(5,"label",4),t._uU(6,"Details :"),t.qZA(),t._UZ(7,"input",5),t.qZA(),t.YNc(8,s,2,1,"div",6),t.TgZ(9,"div",3)(10,"label",7),t._uU(11,"phone :"),t.qZA(),t._UZ(12,"input",8),t.qZA(),t.YNc(13,U,3,2,"div",6),t.TgZ(14,"div",3)(15,"label",9),t._uU(16,"city :"),t.qZA(),t._UZ(17,"input",10),t.qZA(),t.YNc(18,I,2,1,"div",6),t.TgZ(19,"button",11),t._uU(20,"CheckOut"),t.qZA()()()),2&o){let m,d,h;t.xp6(3),t.Q6J("formGroup",l.orderForm),t.xp6(5),t.Q6J("ngIf",(null==(m=l.orderForm.get("details"))?null:m.errors)&&(null==(m=l.orderForm.get("details"))?null:m.touched)),t.xp6(5),t.Q6J("ngIf",(null==(d=l.orderForm.get("phone"))?null:d.errors)&&(null==(d=l.orderForm.get("phone"))?null:d.touched)),t.xp6(5),t.Q6J("ngIf",(null==(h=l.orderForm.get("city"))?null:h.errors)&&(null==(h=l.orderForm.get("city"))?null:h.touched)),t.xp6(1),t.Q6J("disabled",!l.orderForm.valid)}},dependencies:[c.ez,c.O5,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}return e})()},6286:(f,p,i)=>{i.d(p,{N:()=>g});var c=i(5619),r=i(4769),t=i(9862);let g=(()=>{class a{constructor(s){this._HttpClient=s,this.cartNumber=new c.X(0),this.baseUrl="https://ecommerce.routemisr.com/api/v1/",this.userUrl="https://youssefamr-joo.github.io"}addToCart(s){return this._HttpClient.post(this.baseUrl+"cart",{productId:s})}getCart(){return this._HttpClient.get(this.baseUrl+"cart")}removeCartItem(s){return this._HttpClient.delete(this.baseUrl+`cart/${s}`)}updateCartItem(s,u){return this._HttpClient.put(this.baseUrl+`cart/${s}`,{count:u})}clearUserCart(){return this._HttpClient.delete(this.baseUrl+"cart")}checkOut(s,u){return this.userUrl="https://youssefamr-joo.github.io"==this.userUrl?"https://youssefamr-joo.github.io/Fresh-Cart":"https://localhost:4200/",this._HttpClient.post(this.baseUrl+`orders/checkout-session/${s}?url=${this.userUrl}`,{shippingAddress:u})}static#t=this.\u0275fac=function(u){return new(u||a)(r.LFG(t.eN))};static#e=this.\u0275prov=r.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()}}]);